# Environment configuration for scripts/run_tshark_capture.sh
# Copy to /etc/tshark_capture.env or another secure location and adjust values.

# Network interface to capture from (run `ip link` to list).
TSHARK_CAPTURE_INTERFACE="eth0"

# Directory where rotating PCAP files will be written.
TSHARK_CAPTURE_OUTPUT_DIR="/var/lib/pcap-stream"

# Optional prefix for generated file names (default: capture).
# TSHARK_CAPTURE_FILE_PREFIX="live"

# Ring buffer configuration (filesize in megabytes, file count for rotation).
TSHARK_CAPTURE_RING_FILE_SIZE_MB="200"
TSHARK_CAPTURE_RING_FILE_COUNT="20"

# Optional BPF filter applied to the capture (e.g., "port 80").
# TSHARK_CAPTURE_BPF_FILTER="tcp port 443"

# Additional tshark CLI options (avoid quotes requiring spaces unless necessary).
# TSHARK_CAPTURE_EXTRA_OPTIONS="--compress"

# Directory for log files. The script appends to <prefix>.log inside this path.
TSHARK_CAPTURE_LOG_DIR="/var/log/tshark"

# User owning generated artifacts (must have permissions on interface/output dir).
# TSHARK_CAPTURE_USER="pcap"

